{
  "stage": "stage1",
  "step": 9,
  "completed": true,
  "completed_at": "2026-01-07T22:43:52.210800+08:00",
  "model_name": "Qwen/Qwen3-Reranker-4B",
  "lora_config": {
    "r": 16,
    "alpha": 32,
    "dropout": 0.1,
    "target_modules": [
      "q_proj",
      "k_proj",
      "v_proj",
      "o_proj"
    ]
  },
  "training_args": {
    "learning_rate": 1e-05,
    "num_train_epochs": 3,
    "per_device_train_batch_size": 1,
    "gradient_accumulation_steps": 32,
    "warmup_ratio": 0.1,
    "eval_steps": 999999,
    "save_steps": 50,
    "keep_checkpoints": false,
    "max_length": 128,
    "max_neg": 1
  },
  "best_metrics": {
    "metric_name": "eval_loss",
    "best_metric": 0.8686241507530212,
    "metrics": {
      "eval_loss": 0.8686241507530212,
      "eval_model_preparation_time": 0.0083,
      "eval_runtime": 129.9128,
      "eval_samples_per_second": 1.901,
      "eval_steps_per_second": 1.901,
      "epoch": 3.0
    },
    "best_at_step": 120,
    "best_at_epoch": 3.0,
    "updated_at": "2026-01-07T22:43:52.197762+08:00"
  },
  "artifacts_dir": "data/output/artifacts/reranker/qwen-qwen3-reranker-4b/run_20260107-212315",
  "data_manifest": {
    "train_data": "data/output/train/train_triplets_stage1.jsonl",
    "dev_data": "data/output/train/dev_triplets_stage1.jsonl",
    "train_samples": 1274,
    "dev_samples": 247,
    "train_query_ids": 179,
    "dev_query_ids": 20,
    "blacklist_file": "config/eval_blacklist.json",
    "blacklist_count": 50,
    "blacklist_source": "gold_eval_50_final",
    "gold_eval_file": "data/output/annotations/gold_eval_50_extended_final.jsonl",
    "training_script": "scripts/09_train_reranker.py",
    "git_commit": "738d21fa35e4aa6d9be03f057e8a4bfe8e5ee476",
    "created_at": "2026-01-07T22:43:52.210145+08:00",
    "neg_stats": {
      "min": 3,
      "max": 36,
      "avg": 14.373626373626374,
      "median": 12.0,
      "p75": 21,
      "p95": 34
    }
  },
  "validation": {
    "initial_eval_loss": 1.07931649684906,
    "final_eval_loss": 0.8686241507530212,
    "loss_drop_percentage": 19.52090482366672,
    "meets_acceptance": false
  }
}